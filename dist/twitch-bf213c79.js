import{_ as e}from"./_tslib-6d5bfba3.js";function n(n,t,i="",o=""){return e(this,void 0,void 0,(function*(){const e={operationName:"PlaybackAccessToken_Template",query:'\n    query PlaybackAccessToken_Template($login: String!, $isLive: Boolean!, $vodID: ID!, $isVod: Boolean!, $playerType: String!) {\n      streamPlaybackAccessToken(channelName: $login, params: {platform: "web", playerBackend: "mediaplayer", playerType: $playerType}) @include(if: $isLive) {\n        value\n        signature\n      }\n      videoPlaybackAccessToken(id: $vodID, params: {platform: "web", playerBackend: "mediaplayer", playerType: $playerType}) @include(if: $isVod) {\n        value\n        signature\n      }\n    }',variables:{isLive:t,login:i,isVod:!t,vodID:o,playerType:"site"}},a=yield fetch("https://gql.twitch.tv/gql",{method:"POST",headers:{"Content-Type":"text/plain; charset=UTF-8","Client-ID":n},body:JSON.stringify(e)});return yield a.json()}))}function t(){return commonOptions.headers["Client-ID"]}function i(t,i){return e(this,void 0,void 0,(function*(){const o=yield function(t,i){return e(this,void 0,void 0,(function*(){const e=yield n(t,!0,i,void 0),{value:o,signature:a}=e.data.streamPlaybackAccessToken;return{token:o,signature:a}}))}(i,t),{signature:a}=o,r=encodeURIComponent(o.token);return`https://usher.ttvnw.net/api/channel/hls/${t}.m3u8?sig=${a}&token=${r}`}))}function o(t,i){return e(this,void 0,void 0,(function*(){const o=yield function(t,i){return e(this,void 0,void 0,(function*(){const e=yield n(t,!1,void 0,i),{value:o,signature:a}=e.data.videoPlaybackAccessToken;return{token:o,signature:a}}))}(i,t),{signature:a}=o,r=encodeURIComponent(o.token);return`https://usher.ttvnw.net/vod/${t}.m3u8?sig=${a}&token=${r}`}))}function a(){return e(this,void 0,void 0,(function*(){const e=function(){const{pathname:e}=window.location,n=e.match(/^\/(\w+)$/);return!!n&&n[1]}();if(e){const n=t(),o=yield i(e,n);window.location.href=o}else{const e=function(){const e=window.location.href.match(/^.*twitch\.tv\/videos\/([0-9]+)*/);return!!e&&e[1]}();if(e){const n=t(),i=yield o(e,n);window.location.href=i}}}))}export{a as default};
//# sourceMappingURL=twitch-bf213c79.js.map
