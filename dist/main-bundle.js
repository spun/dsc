function e(e,t,o,n){return new(o||(o=Promise))((function(i,c){function a(e){try{d(n.next(e))}catch(e){c(e)}}function r(e){try{d(n.throw(e))}catch(e){c(e)}}function d(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,r)}d((n=n.apply(e,t||[])).next())}))}"function"==typeof SuppressedError&&SuppressedError;const t={5:{ext:"flv",width:400,height:240,acodec:"mp3",abr:64,vcodec:"h263"},6:{ext:"flv",width:450,height:270,acodec:"mp3",abr:64,vcodec:"h263"},13:{ext:"3gp",acodec:"aac",vcodec:"mp4v"},17:{ext:"3gp",width:176,height:144,acodec:"aac",abr:24,vcodec:"mp4v"},18:{ext:"mp4",width:640,height:360,acodec:"aac",abr:96,vcodec:"h264"},22:{ext:"mp4",width:1280,height:720,acodec:"aac",abr:192,vcodec:"h264"},34:{ext:"flv",width:640,height:360,acodec:"aac",abr:128,vcodec:"h264"},35:{ext:"flv",width:854,height:480,acodec:"aac",abr:128,vcodec:"h264"},36:{ext:"3gp",width:320,acodec:"aac",vcodec:"mp4v"},37:{ext:"mp4",width:1920,height:1080,acodec:"aac",abr:192,vcodec:"h264"},38:{ext:"mp4",width:4096,height:3072,acodec:"aac",abr:192,vcodec:"h264"},43:{ext:"webm",width:640,height:360,acodec:"vorbis",abr:128,vcodec:"vp8"},44:{ext:"webm",width:854,height:480,acodec:"vorbis",abr:128,vcodec:"vp8"},45:{ext:"webm",width:1280,height:720,acodec:"vorbis",abr:192,vcodec:"vp8"},46:{ext:"webm",width:1920,height:1080,acodec:"vorbis",abr:192,vcodec:"vp8"},59:{ext:"mp4",width:854,height:480,acodec:"aac",abr:128,vcodec:"h264"},78:{ext:"mp4",width:854,height:480,acodec:"aac",abr:128,vcodec:"h264"},82:{ext:"mp4",height:360,format_note:"3D",acodec:"aac",abr:128,vcodec:"h264",preference:-20},83:{ext:"mp4",height:480,format_note:"3D",acodec:"aac",abr:128,vcodec:"h264",preference:-20},84:{ext:"mp4",height:720,format_note:"3D",acodec:"aac",abr:192,vcodec:"h264",preference:-20},85:{ext:"mp4",height:1080,format_note:"3D",acodec:"aac",abr:192,vcodec:"h264",preference:-20},100:{ext:"webm",height:360,format_note:"3D",acodec:"vorbis",abr:128,vcodec:"vp8",preference:-20},101:{ext:"webm",height:480,format_note:"3D",acodec:"vorbis",abr:192,vcodec:"vp8",preference:-20},102:{ext:"webm",height:720,format_note:"3D",acodec:"vorbis",abr:192,vcodec:"vp8",preference:-20},91:{ext:"mp4",height:144,format_note:"HLS",acodec:"aac",abr:48,vcodec:"h264",preference:-10},92:{ext:"mp4",height:240,format_note:"HLS",acodec:"aac",abr:48,vcodec:"h264",preference:-10},93:{ext:"mp4",height:360,format_note:"HLS",acodec:"aac",abr:128,vcodec:"h264",preference:-10},94:{ext:"mp4",height:480,format_note:"HLS",acodec:"aac",abr:128,vcodec:"h264",preference:-10},95:{ext:"mp4",height:720,format_note:"HLS",acodec:"aac",abr:256,vcodec:"h264",preference:-10},96:{ext:"mp4",height:1080,format_note:"HLS",acodec:"aac",abr:256,vcodec:"h264",preference:-10},132:{ext:"mp4",height:240,format_note:"HLS",acodec:"aac",abr:48,vcodec:"h264",preference:-10},151:{ext:"mp4",height:72,format_note:"HLS",acodec:"aac",abr:24,vcodec:"h264",preference:-10},133:{ext:"mp4",height:240,format_note:"DASH video",vcodec:"h264"},134:{ext:"mp4",height:360,format_note:"DASH video",vcodec:"h264"},135:{ext:"mp4",height:480,format_note:"DASH video",vcodec:"h264"},136:{ext:"mp4",height:720,format_note:"DASH video",vcodec:"h264"},137:{ext:"mp4",height:1080,format_note:"DASH video",vcodec:"h264"},138:{ext:"mp4",format_note:"DASH video",vcodec:"h264"},160:{ext:"mp4",height:144,format_note:"DASH video",vcodec:"h264"},212:{ext:"mp4",height:480,format_note:"DASH video",vcodec:"h264"},264:{ext:"mp4",height:1440,format_note:"DASH video",vcodec:"h264"},298:{ext:"mp4",height:720,format_note:"DASH video",vcodec:"h264",fps:60},299:{ext:"mp4",height:1080,format_note:"DASH video",vcodec:"h264",fps:60},266:{ext:"mp4",height:2160,format_note:"DASH video",vcodec:"h264"},139:{ext:"m4a",format_note:"DASH audio",acodec:"aac",abr:48,container:"m4a_dash"},140:{ext:"m4a",format_note:"DASH audio",acodec:"aac",abr:128,container:"m4a_dash"},141:{ext:"m4a",format_note:"DASH audio",acodec:"aac",abr:256,container:"m4a_dash"},256:{ext:"m4a",format_note:"DASH audio",acodec:"aac",container:"m4a_dash"},258:{ext:"m4a",format_note:"DASH audio",acodec:"aac",container:"m4a_dash"},325:{ext:"m4a",format_note:"DASH audio",acodec:"dtse",container:"m4a_dash"},328:{ext:"m4a",format_note:"DASH audio",acodec:"ec-3",container:"m4a_dash"},167:{ext:"webm",height:360,width:640,format_note:"DASH video",container:"webm",vcodec:"vp8"},168:{ext:"webm",height:480,width:854,format_note:"DASH video",container:"webm",vcodec:"vp8"},169:{ext:"webm",height:720,width:1280,format_note:"DASH video",container:"webm",vcodec:"vp8"},170:{ext:"webm",height:1080,width:1920,format_note:"DASH video",container:"webm",vcodec:"vp8"},218:{ext:"webm",height:480,width:854,format_note:"DASH video",container:"webm",vcodec:"vp8"},219:{ext:"webm",height:480,width:854,format_note:"DASH video",container:"webm",vcodec:"vp8"},278:{ext:"webm",height:144,format_note:"DASH video",container:"webm",vcodec:"vp9"},242:{ext:"webm",height:240,format_note:"DASH video",vcodec:"vp9"},243:{ext:"webm",height:360,format_note:"DASH video",vcodec:"vp9"},244:{ext:"webm",height:480,format_note:"DASH video",vcodec:"vp9"},245:{ext:"webm",height:480,format_note:"DASH video",vcodec:"vp9"},246:{ext:"webm",height:480,format_note:"DASH video",vcodec:"vp9"},247:{ext:"webm",height:720,format_note:"DASH video",vcodec:"vp9"},248:{ext:"webm",height:1080,format_note:"DASH video",vcodec:"vp9"},271:{ext:"webm",height:1440,format_note:"DASH video",vcodec:"vp9"},272:{ext:"webm",height:2160,format_note:"DASH video",vcodec:"vp9"},302:{ext:"webm",height:720,format_note:"DASH video",vcodec:"vp9",fps:60},303:{ext:"webm",height:1080,format_note:"DASH video",vcodec:"vp9",fps:60},308:{ext:"webm",height:1440,format_note:"DASH video",vcodec:"vp9",fps:60},313:{ext:"webm",height:2160,format_note:"DASH video",vcodec:"vp9"},315:{ext:"webm",height:2160,format_note:"DASH video",vcodec:"vp9",fps:60},171:{ext:"webm",acodec:"vorbis",format_note:"DASH audio",abr:128},172:{ext:"webm",acodec:"vorbis",format_note:"DASH audio",abr:256},249:{ext:"webm",format_note:"DASH audio",acodec:"opus",abr:50},250:{ext:"webm",format_note:"DASH audio",acodec:"opus",abr:70},251:{ext:"webm",format_note:"DASH audio",acodec:"opus",abr:160},394:{acodec:"none",vcodec:"av01.0.05M.08"},395:{acodec:"none",vcodec:"av01.0.05M.08"},396:{acodec:"none",vcodec:"av01.0.05M.08"},397:{acodec:"none",vcodec:"av01.0.05M.08"}};function o(e){return function(e){return`${e.hours.toString().padStart(2,"0")}:${e.minutes.toString().padStart(2,"0")}:${e.seconds.toString().padStart(2,"0")},${e.milliseconds.toString().padStart(3,"0")}`}(function(e){const t=e%1e3,o=Math.floor(e/1e3)%60,n=Math.floor(e/6e4)%60;return{hours:Math.floor(e/36e5),minutes:n,seconds:o,milliseconds:t}}(e>=0?e:0))}var n;!function(e,t){void 0===t&&(t={});var o=t.insertAt;if(e&&"undefined"!=typeof document){var n=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css","top"===o&&n.firstChild?n.insertBefore(i,n.firstChild):n.appendChild(i),i.styleSheet?i.styleSheet.cssText=e:i.appendChild(document.createTextNode(e))}}("#dsc_popup.card {\n  font-family: sans-serif;\n  font-size: 12px;\n  position: fixed;\n  background: #fff;\n  width: 360px;\n  right: 16px;\n  bottom: 16px;\n  z-index: 2202;\n  border-radius: 2px;\n  box-shadow: 0 10px 20px rgba(0, 0, 0, 0.19), 0 6px 6px rgba(0, 0, 0, 0.23);\n  animation: animateElement linear 0.3s;\n  transition: opacity 0.3s ease-out;\n}\n#dsc_popup.card * {\n  font-size: 100%;\n  margin: 0;\n  padding: 0;\n  line-height: 1;\n}\n\n#dsc_popup.card .header {\n  font-weight: bold;\n  position: relative;\n  background: #ff0000;\n  border-radius: 2px 2px 0 0;\n  box-shadow: 0 3px 6px -2px #808080;\n  overflow: hidden;\n  display: flex;\n}\n\n#dsc_popup.card .header .title {\n  color: #fff;\n  padding: 16px;\n  flex-grow: 1;\n}\n\n#dsc_popup.card .header .close-popup-button,\n#dsc_popup.card .header .minimize-popup-button {\n  padding: 16px;\n  color: #fff;\n  text-align: center;\n  cursor: pointer;\n}\n\n#dsc_popup.card .header .close-popup-button:hover,\n#dsc_popup.card .header .minimize-popup-button:hover {\n  background: #ca0000;\n}\n\n#dsc_popup.card .list {\n  list-style-type: none;\n  max-height: 240px;\n  overflow-y: scroll;\n  transition: max-height 0.3s ease-out;\n}\n\n#dsc_popup.card .list .list-item a {\n  padding: 16px;\n  text-decoration: none;\n  display: block;\n}\n\n#dsc_popup.card .list .list-item a .title {\n  color: #000;\n}\n\n#dsc_popup.card .list .list-item a .subtitle {\n  color: #0000008a;\n  margin-top: 4px;\n}\n\n#dsc_popup.card .list .list-item a {\n  text-decoration: none;\n  padding: 16px;\n  display: block;\n}\n\n#dsc_popup.card .list .list-item:hover {\n  background: rgb(245, 245, 245);\n}\n\n#dsc_popup.card .list .list-item:active {\n  background: #bebebe;\n}\n\n@keyframes animateElement {\n  0% {\n    opacity: 0;\n    transform: translate(0px, 10px);\n  }\n  100% {\n    opacity: 1;\n    transform: translate(0px, 0px);\n  }\n}\n\n/* Minimize */\n#dsc_popup.card.minimize .header .title {\n  cursor: pointer;\n}\n\n#dsc_popup.card.minimize .list {\n  max-height: 0;\n  transition: max-height 0.3s ease-out;\n}\n\n#dsc_popup.card.minimize {\n  opacity: 0.5;\n  transition: opacity 0.3s ease-out;\n}\n\n#dsc_popup.card.minimize:hover {\n  opacity: 1;\n}\n");class i{constructor(e){this.boxId="dsc_popup",this.boxElement=function(){const e=document.createElement("div");return e.classList.add("card"),e}(),this.boxElement.id=this.boxId,this.headerElement=function(e){const t=document.createElement("p");t.classList.add("header");const o=document.createElement("span");o.textContent="Available formats",o.classList.add("title"),o.onclick=()=>e.restore(),t.appendChild(o);const n=document.createElement("span");n.classList.add("minimize-popup-button"),n.textContent="_",n.onclick=()=>e.toggle(),t.appendChild(n);const i=document.createElement("span");return i.classList.add("close-popup-button"),i.textContent="X",i.onclick=()=>e.hide(),t.appendChild(i),t}(this),this.boxElement.appendChild(this.headerElement),this.listElement=function(){const e=document.createElement("ul");return e.classList.add("list"),e}(),this.boxElement.appendChild(this.listElement),this.clickListener=e}addItemToList(e){const t=function(e,t,o){const n=document.createElement("li");n.classList.add("list-item");const i=document.createElement("a");i.href=o,n.appendChild(i);const c=document.createElement("p");c.classList.add("title"),c.textContent=e,i.appendChild(c);const a=document.createElement("p");return a.classList.add("subtitle"),a.textContent=t,i.appendChild(a),n}(e.title,e.subtitle,e.url);t.onclick=()=>(this.clickListener(e),!1),this.listElement.appendChild(t)}show(){this.hide(),document.body.appendChild(this.boxElement)}hide(){const e=document.getElementById(this.boxId);if(null!=e){const t=e.parentElement;t&&t.removeChild(e)}}minimize(){this.boxElement.classList.add("minimize")}restore(){this.boxElement.classList.remove("minimize")}toggle(){this.boxElement.classList.contains("minimize")?this.restore():this.minimize()}}function c(e){const t=e.match(/^.*(youtu\.be\/|v\/|u\/\w\/|embed\/|watch\?v=|&v=)([^#&?]*).*/);return t?t[2]:""}function a(e){const{formats:o,adaptiveFormats:n}=e.streamingData,i=o.concat(n).filter((e=>e)),c=escape(e.videoDetails.title.replace(/"/g,""))||"download",a=[];return i.forEach((e=>{const o=function(e){let o="Unknown",n="";const i=t[e];if(i){o=`${function(e){return e.width&&e.height?`${e.width} x ${e.height}`:e.width||e.height?`${e.width||e.height}`:""}(i)} (${i.ext})`,i.format_note&&(o+=` - ${i.format_note}`);const t=[];i.vcodec&&t.push(`video: ${i.vcodec}`),i.acodec&&t.push(`audio: ${i.acodec}`),n=t.length>0?t.join(" + "):`itag: ${e}`}return{text:o,subtext:n}}(e.itag);a.push({title:o.text,subtitle:o.subtext||e.size||e.quality||"",url:`${e.url}&title=${c}`})})),a}function r(){var t,o,n,i;return e(this,void 0,void 0,(function*(){const r=c(window.location.href);if(""!==r){let c=!1;const d=null===(o=null===(t=null===ytplayer||void 0===ytplayer?void 0:ytplayer.config)||void 0===t?void 0:t.args)||void 0===o?void 0:o.video_id;if(d&&r===d&&(c=!0),!0===c&&(null===(i=null===(n=null===ytplayer||void 0===ytplayer?void 0:ytplayer.config)||void 0===n?void 0:n.args)||void 0===i?void 0:i.raw_player_response)){console.info('Using method 1, "getFormatsUsingYtPlayerPlayerResponse"');return a(ytplayer.config.args.raw_player_response)}console.info('Using method 2, "getPlayerResponseFromApi"');try{return a(yield function(t){return e(this,void 0,void 0,(function*(){const{INNERTUBE_API_KEY:e,INNERTUBE_CONTEXT_CLIENT_VERSION:o,INNERTUBE_CONTEXT_HL:n,INNERTUBE_CONTEXT_CLIENT_NAME:i}=ytcfg.data_,c={context:{client:{hl:n,clientName:i,clientVersion:o,mainAppWebInfo:{graftUrl:`/watch?v=${t}`}}},videoId:t},a=`https://youtubei.googleapis.com/youtubei/v1/player?key=${e}`;return(yield fetch(a,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)})).json()}))}(r))}catch(e){throw new Error(`getPlayerResponseFromApi failed: ${e}`)}}throw new Error}))}function d(){return e(this,void 0,void 0,(function*(){const t=new i((t=>e(this,void 0,void 0,(function*(){const i=t;switch(i.type){case n.VIDEO:window.location.href=i.url;break;case n.SUBTITLE:yield function(t){return e(this,void 0,void 0,(function*(){if(!t.extras)return;const{baseUrl:e}=t.extras,n=yield fetch(`${e}&fmt=json3`),i=yield n.json();let c="",a=1;i.events.forEach((e=>{e.tStartMs&&e.dDurationMs&&e.segs&&(c+=`${a}\r\n`,c+=`${o(e.tStartMs)} --\x3e ${o(e.tStartMs+e.dDurationMs)}\r\n`,e.segs.forEach((e=>{c+=`${e.utf8}\r\n`})),c+="\r\n",a+=1)}));const r=new Blob([c],{type:"text/plain"}),d=window.document.createElement("a");d.href=window.URL.createObjectURL(r),d.download="subtitle.srt",document.body.appendChild(d),d.click(),document.body.removeChild(d)}))}(i)}}))));try{(yield r()).forEach((e=>{const o=Object.assign(Object.assign({},e),{type:n.VIDEO});t.addItemToList(o)})),t.show()}catch(e){console.error("An error occurred",e)}(function(){var e,t;const o=c(window.location.href);if(""!==o){const n=null===(t=null===(e=null===ytplayer||void 0===ytplayer?void 0:ytplayer.config)||void 0===e?void 0:e.args)||void 0===t?void 0:t.video_id;return n&&n===o?ytplayer.config.args.raw_player_response.captions.playerCaptionsTracklistRenderer.captionTracks.map((e=>({title:e.name.simpleText,subtitle:`Subtitle ${e.languageCode}`,url:"",extras:{baseUrl:e.baseUrl}}))):[]}return[]})().forEach((e=>{const o=Object.assign(Object.assign({},e),{type:n.SUBTITLE});t.addItemToList(o)})),t.show()}))}function s(t,o,n="",i=""){return e(this,void 0,void 0,(function*(){const e={operationName:"PlaybackAccessToken_Template",query:'\n    query PlaybackAccessToken_Template($login: String!, $isLive: Boolean!, $vodID: ID!, $isVod: Boolean!, $playerType: String!) {\n      streamPlaybackAccessToken(channelName: $login, params: {platform: "web", playerBackend: "mediaplayer", playerType: $playerType}) @include(if: $isLive) {\n        value\n        signature\n      }\n      videoPlaybackAccessToken(id: $vodID, params: {platform: "web", playerBackend: "mediaplayer", playerType: $playerType}) @include(if: $isVod) {\n        value\n        signature\n      }\n    }',variables:{isLive:o,login:n,isVod:!o,vodID:i,playerType:"site"}},c=yield fetch("https://gql.twitch.tv/gql",{method:"POST",headers:{"Content-Type":"text/plain; charset=UTF-8","Client-ID":t},body:JSON.stringify(e)});return yield c.json()}))}function h(){return commonOptions.headers["Client-ID"]}function p(t,o){return e(this,void 0,void 0,(function*(){const n=yield function(t,o){return e(this,void 0,void 0,(function*(){const e=yield s(t,!0,o,void 0),{value:n,signature:i}=e.data.streamPlaybackAccessToken;return{token:n,signature:i}}))}(o,t),{signature:i}=n,c=encodeURIComponent(n.token);return`https://usher.ttvnw.net/api/channel/hls/${t}.m3u8?sig=${i}&token=${c}`}))}function m(t,o){return e(this,void 0,void 0,(function*(){const n=yield function(t,o){return e(this,void 0,void 0,(function*(){const e=yield s(t,!1,void 0,o),{value:n,signature:i}=e.data.videoPlaybackAccessToken;return{token:n,signature:i}}))}(o,t),{signature:i}=n,c=encodeURIComponent(n.token);return`https://usher.ttvnw.net/vod/${t}.m3u8?sig=${i}&token=${c}`}))}function l(){return e(this,void 0,void 0,(function*(){const e=function(){const{pathname:e}=window.location,t=e.match(/^\/(\w+)\/?$/);return!!t&&t[1]}();if(e){const t=h(),o=yield p(e,t);window.location.href=o}else{const e=function(){const e=window.location.href;return function(e){const t=e.match(/^.*twitch\.tv\/videos\/([0-9]+)*/);if(t)return t[1]}(e)||function(e){const t=e.match(/^.*twitch\.tv\/.*\/video\/([0-9]+)*/);if(t)return t[1]}(e)}();if(e){const t=h(),o=yield m(e,t);window.location.href=o}}}))}function u(e){const t=e.split("manifest.m3u8")[0];fetch(e).then((e=>e.text())).then((e=>{!function(e,t){const o=new Blob([t],{type:"text/plain"}),n=window.document.createElement("a");n.href=window.URL.createObjectURL(o),n.download=e,document.body.appendChild(n),n.click(),document.body.removeChild(n)}("result.m3u8",e.replace(/^.*\d+\.ts$/gm,(e=>t+e)))})).catch((e=>{console.error(e)}))}!function(e){e.VIDEO="element_type_video",e.SUBTITLE="element_type_subtitle"}(n||(n={}));var v=()=>{u(function(){const e=window.performance.getEntriesByType("resource").filter((e=>e.name.includes("manifest.m3u8")));return e[e.length-1].name}())};(()=>{switch(document.domain){case"www.youtube.com":d();break;case"www.twitch.tv":case"twitch.tv":l();break;case"mixer.com":v();break;default:console.log(`Unknown domain: ${document.domain}`)}})();
//# sourceMappingURL=main-bundle.js.map
