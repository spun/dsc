{"version":3,"file":"mixer-Cjod6ASK.js","sources":["../../src-bookmarklet/mixer/mixer.ts"],"sourcesContent":["function getManifestUrl() {\n  const results = window.performance\n    .getEntriesByType('resource')\n    // .filter(resource => resource.initiatorType === 'xmlhttprequest') // changes between browsers\n    .filter((request) => request.name.includes('manifest.m3u8'));\n\n  return results[results.length - 1].name;\n}\n\n// Create and trigger file dowload (https://stackoverflow.com/a/33542499)\nfunction downloadAsFile(filename: string, text: string) {\n  const blob = new Blob([text], { type: 'text/plain' });\n  const elem = window.document.createElement('a');\n  elem.href = window.URL.createObjectURL(blob);\n  elem.download = filename;\n  // Add to dom\n  document.body.appendChild(elem);\n  // trigger click event\n  elem.click();\n  // remove from dom\n  document.body.removeChild(elem);\n}\n\nfunction getManifestText(manifestUrl: string) {\n  const baseUrl = manifestUrl.split('manifest.m3u8')[0];\n\n  fetch(manifestUrl)\n    .then((response) => response.text())\n    .then((text) => {\n      const result = text.replace(/^.*\\d+\\.ts$/gm, (value) => baseUrl + value);\n      downloadAsFile('result.m3u8', result);\n    })\n    .catch((e) => {\n      console.error(e);\n    });\n}\n\nexport default (): void => {\n  const manifestUrl = getManifestUrl();\n  getManifestText(manifestUrl);\n};\n"],"names":["getManifestText","manifestUrl","baseUrl","split","fetch","then","response","text","filename","blob","Blob","type","elem","window","document","createElement","href","URL","createObjectURL","download","body","appendChild","click","removeChild","downloadAsFile","replace","value","catch","e","console","error","mixer","results","performance","getEntriesByType","filter","request","name","includes","length","getManifestUrl"],"mappings":"AAuBA,SAASA,EAAgBC,GACvB,MAAMC,EAAUD,EAAYE,MAAM,iBAAiB,GAEnDC,MAAMH,GACHI,MAAMC,GAAaA,EAASC,SAC5BF,MAAME,KAlBX,SAAwBC,EAAkBD,GACxC,MAAME,EAAO,IAAIC,KAAK,CAACH,GAAO,CAAEI,KAAM,eAChCC,EAAOC,OAAOC,SAASC,cAAc,KAC3CH,EAAKI,KAAOH,OAAOI,IAAIC,gBAAgBT,GACvCG,EAAKO,SAAWX,EAEhBM,SAASM,KAAKC,YAAYT,GAE1BA,EAAKU,QAELR,SAASM,KAAKG,YAAYX,EAC5B,CASMY,CAAe,cADAjB,EAAKkB,QAAQ,iBAAkBC,GAAUxB,EAAUwB,IAC7B,IAEtCC,OAAOC,IACNC,QAAQC,MAAMF,EAAE,GAEtB,CAEA,IAAAG,EAAe,KAEb/B,EAvCF,WACE,MAAMgC,EAAUnB,OAAOoB,YACpBC,iBAAiB,YAEjBC,QAAQC,GAAYA,EAAQC,KAAKC,SAAS,mBAE7C,OAAON,EAAQA,EAAQO,OAAS,GAAGF,IACrC,CA+BsBG,GACQ"}