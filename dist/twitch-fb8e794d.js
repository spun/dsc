import{_ as e,a as n}from"./_tslib-1bb0b18c.js";function t(t,a,i,r){return void 0===i&&(i=""),void 0===r&&(r=""),e(this,void 0,void 0,(function(){var e;return n(this,(function(n){switch(n.label){case 0:return'\n    query PlaybackAccessToken_Template($login: String!, $isLive: Boolean!, $vodID: ID!, $isVod: Boolean!, $playerType: String!) {\n      streamPlaybackAccessToken(channelName: $login, params: {platform: "web", playerBackend: "mediaplayer", playerType: $playerType}) @include(if: $isLive) {\n        value\n        signature\n      }\n      videoPlaybackAccessToken(id: $vodID, params: {platform: "web", playerBackend: "mediaplayer", playerType: $playerType}) @include(if: $isVod) {\n        value\n        signature\n      }\n    }',"https://gql.twitch.tv/gql",e={operationName:"PlaybackAccessToken_Template",query:'\n    query PlaybackAccessToken_Template($login: String!, $isLive: Boolean!, $vodID: ID!, $isVod: Boolean!, $playerType: String!) {\n      streamPlaybackAccessToken(channelName: $login, params: {platform: "web", playerBackend: "mediaplayer", playerType: $playerType}) @include(if: $isLive) {\n        value\n        signature\n      }\n      videoPlaybackAccessToken(id: $vodID, params: {platform: "web", playerBackend: "mediaplayer", playerType: $playerType}) @include(if: $isVod) {\n        value\n        signature\n      }\n    }',variables:{isLive:a,login:i,isVod:!a,vodID:r,playerType:"site"}},[4,fetch("https://gql.twitch.tv/gql",{method:"POST",headers:{"Content-Type":"text/plain; charset=UTF-8","Client-ID":t},body:JSON.stringify(e)})];case 1:return[4,n.sent().json()];case 2:return[2,n.sent()]}}))}))}function a(a,i){return e(this,void 0,void 0,(function(){var e,r,o,s;return n(this,(function(n){switch(n.label){case 0:return[4,t(a,!0,i,void 0)];case 1:return e=n.sent(),r=e.data.streamPlaybackAccessToken,o=r.value,s=r.signature,[2,{token:o,signature:s}]}}))}))}function i(a,i){return e(this,void 0,void 0,(function(){var e,r,o,s;return n(this,(function(n){switch(n.label){case 0:return[4,t(a,!1,void 0,i)];case 1:return e=n.sent(),r=e.data.videoPlaybackAccessToken,o=r.value,s=r.signature,[2,{token:o,signature:s}]}}))}))}function r(){return commonOptions.headers["Client-ID"]}function o(t,i){return e(this,void 0,void 0,(function(){var e,r,o;return n(this,(function(n){switch(n.label){case 0:return[4,a(i,t)];case 1:return e=n.sent(),r=e.signature,o=encodeURIComponent(e.token),[2,"https://usher.ttvnw.net/api/channel/hls/".concat(t,".m3u8?sig=").concat(r,"&token=").concat(o)]}}))}))}function s(t,a){return e(this,void 0,void 0,(function(){var e,r,o;return n(this,(function(n){switch(n.label){case 0:return[4,i(a,t)];case 1:return e=n.sent(),r=e.signature,o=encodeURIComponent(e.token),[2,"https://usher.ttvnw.net/vod/".concat(t,".m3u8?sig=").concat(r,"&token=").concat(o)]}}))}))}function c(){return e(this,void 0,void 0,(function(){var e,t,a,i,c;return n(this,(function(n){switch(n.label){case 0:return u=window.location.pathname.match(/^\/(\w+)\/?$/),(e=!!u&&u[1])?(i=r(),[4,o(e,i)]):[3,2];case 1:return t=n.sent(),window.location.href=t,[3,4];case 2:return l=window.location.href,a=function(e){var n=e.match(/^.*twitch\.tv\/videos\/([0-9]+)*/);if(n)return n[1]}(l)||function(e){var n=e.match(/^.*twitch\.tv\/.*\/video\/([0-9]+)*/);if(n)return n[1]}(l),a?(i=r(),[4,s(a,i)]):[3,4];case 3:c=n.sent(),window.location.href=c,n.label=4;case 4:return[2]}var l,u}))}))}export{c as default};
//# sourceMappingURL=twitch-fb8e794d.js.map
