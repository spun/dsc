import{_ as n}from"./_tslib-NbJOzQvB.js";function e(e,t,i="",o=""){return n(this,void 0,void 0,(function*(){const n={operationName:"PlaybackAccessToken_Template",query:'\n    query PlaybackAccessToken_Template($login: String!, $isLive: Boolean!, $vodID: ID!, $isVod: Boolean!, $playerType: String!) {\n      streamPlaybackAccessToken(channelName: $login, params: {platform: "web", playerBackend: "mediaplayer", playerType: $playerType}) @include(if: $isLive) {\n        value\n        signature\n      }\n      videoPlaybackAccessToken(id: $vodID, params: {platform: "web", playerBackend: "mediaplayer", playerType: $playerType}) @include(if: $isVod) {\n        value\n        signature\n      }\n    }',variables:{isLive:t,login:i,isVod:!t,vodID:o,playerType:"site"}},a=yield fetch("https://gql.twitch.tv/gql",{method:"POST",headers:{"Content-Type":"text/plain; charset=UTF-8","Client-ID":e},body:JSON.stringify(n)});return yield a.json()}))}function t(){return commonOptions.headers["Client-ID"]}function i(t,i){return n(this,void 0,void 0,(function*(){const o=yield function(t,i){return n(this,void 0,void 0,(function*(){const n=yield e(t,!0,i,void 0),{value:o,signature:a}=n.data.streamPlaybackAccessToken;return{token:o,signature:a}}))}(i,t),{signature:a}=o,r=encodeURIComponent(o.token);return`https://usher.ttvnw.net/api/channel/hls/${t}.m3u8?sig=${a}&token=${r}`}))}function o(t,i){return n(this,void 0,void 0,(function*(){const o=yield function(t,i){return n(this,void 0,void 0,(function*(){const n=yield e(t,!1,void 0,i),{value:o,signature:a}=n.data.videoPlaybackAccessToken;return{token:o,signature:a}}))}(i,t),{signature:a}=o,r=encodeURIComponent(o.token);return`https://usher.ttvnw.net/vod/${t}.m3u8?sig=${a}&token=${r}`}))}function a(){return n(this,void 0,void 0,(function*(){const n=function(){const{pathname:n}=window.location,e=n.match(/^\/(\w+)\/?$/);return!!e&&e[1]}();if(n){const e=t(),o=yield i(n,e);window.location.href=o}else{const n=function(){const n=window.location.href;return function(n){const e=n.match(/^.*twitch\.tv\/videos\/([0-9]+)*/);if(e)return e[1]}(n)||function(n){const e=n.match(/^.*twitch\.tv\/.*\/video\/([0-9]+)*/);if(e)return e[1]}(n)}();if(n){const e=t(),i=yield o(n,e);window.location.href=i}}}))}export{a as default};
//# sourceMappingURL=twitch-Dp3nzQhw.js.map
