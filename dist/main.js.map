{"version":3,"file":"main.js","sources":["../../src-bookmarklet/main.ts"],"sourcesContent":["// src/main.ts\n\nfunction loadFullScript() {\n  // Get url of the bookmarklet\n  const docScripts = document.getElementsByTagName('script');\n  const mainScript = Array.from(docScripts).filter((script) => script.src.endsWith('main.js'));\n  if (mainScript.length === 1) {\n    // Create the url of the \"main-full\" alternative we are going to load\n    const fullMainSrc = mainScript[0].src.replace('main.js', 'main-bundle.js');\n    // Create script tag and load the \"main-full\" bookmarklet\n    const script = document.body.appendChild(document.createElement('script'));\n    script.type = 'module';\n    script.src = fullMainSrc;\n  } else {\n    console.error('Unable to load main-bundle. Unknown script url.');\n  }\n}\n\n(() => {\n  // Check current domain\n  let s;\n  switch (document.domain) {\n    case 'www.youtube.com':\n      s = import('./youtube/youtube');\n      break;\n    case 'www.twitch.tv':\n    case 'twitch.tv':\n      s = import('./twitch/twitch');\n      break;\n    case 'mixer.com':\n      s = import('./mixer/mixer');\n      break;\n    default:\n      console.log(`Unknown domain: ${document.domain}`);\n      break;\n  }\n\n  // run\n  if (s) {\n    s.then((module) => {\n      module.default();\n    }).catch(() => {\n      // Some browsers fail to resolve the final url because import()\n      // is called from a CORS-cross-origin script.\n      // To solve this, we have an alternative main bundle that contains\n      // the scripts of all supported sites.\n      loadFullScript();\n    });\n  }\n})();\n"],"names":["s","document","domain","import","console","log","then","module","default","catch","docScripts","getElementsByTagName","mainScript","Array","from","filter","script","src","endsWith","length","fullMainSrc","replace","body","appendChild","createElement","type","error","loadFullScript"],"mappings":"AAkBA,MAEE,IAAIA,EACJ,OAAQC,SAASC,QACf,IAAK,kBACHF,EAAIG,OAAO,yBACX,MACF,IAAK,gBACL,IAAK,YACHH,EAAIG,OAAO,wBACX,MACF,IAAK,YACHH,EAAIG,OAAO,uBACX,MACF,QACEC,QAAQC,IAAI,mBAAmBJ,SAASC,UAKxCF,GACFA,EAAEM,MAAMC,IACNA,EAAOC,SAAS,IACfC,OAAM,MAvCb,WAEE,MAAMC,EAAaT,SAASU,qBAAqB,UAC3CC,EAAaC,MAAMC,KAAKJ,GAAYK,QAAQC,GAAWA,EAAOC,IAAIC,SAAS,aACjF,GAA0B,IAAtBN,EAAWO,OAAc,CAE3B,MAAMC,EAAcR,EAAW,GAAGK,IAAII,QAAQ,UAAW,kBAEnDL,EAASf,SAASqB,KAAKC,YAAYtB,SAASuB,cAAc,WAChER,EAAOS,KAAO,SACdT,EAAOC,IAAMG,CACd,MACChB,QAAQsB,MAAM,kDAElB,CA8BMC,EAAgB,GAGrB,EA/BD"}