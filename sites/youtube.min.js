var formats={5:{description:"LQ FLV",format:"FLV"},18:{description:"LQ MP4",format:"MP4"},22:{description:"HD 720p MP4",format:"MP4"},34:{description:"LQ FLV",format:"FLV"},35:{description:"HQ 480p FLV",format:"FLV"},37:{description:"Full HD 1080 MP4",format:"MP4"},38:{description:"Original MP4",format:"MP4"},43:{description:"LQ WebM",format:"WebM"},44:{description:"HQ 480p WebM",format:"WebM"},45:{description:"HD 720p WebM",format:"WebM"},46:{description:"Full HD 1080 WebM",format:"WebM"}};function testJquery(b){if(typeof jQuery==="undefined"){var a=document.createElement("script");a.src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js";a.onload=a.onreadystatechange=function(){b()};document.body.appendChild(a)}else{b()}}function getVideoId(e){var d,c,f,b=document.createElement("a");b.href=e;f=b.hostname;if(f.substr(f.length-11)==="youtube.com"&&f!=="m.youtube.com"){d=/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=)([^#\&\?]*).*/;c=e.match(d);if(c&&c[2].length===11){return c[2]}}return false}function getVideoData(a,b){jQuery.ajax({url:"http://www.youtube.com/get_video_info?&video_id="+a,success:function(e){var k,n,l,d,g,c,h,p,m,f,o;k=decodeURIComponent(decodeURIComponent(decodeURIComponent(e)));n=k.split(/[=,]url=/);l=n.length;d=[];for(h=1;h<l;h=h+1){g={};c=n[h].split(/\?(.+)/);g.url=c[0];if(c[1]){p=c[1];if(p[p.length-1]===","){p=p.substring(0,p.length-1)}m=p.split(/&|;\++/);for(f=0;f<m.length;f=f+1){o=m[f].split("=");if(!(o.length>2&&o[o.length-1]!=="")){g[o[0]]=o[1]}}d.push(g)}}b(d)}})}function createVideoUrl(d,b){var a,c,e;a=d.url+"?";a+="sparams="+d.sparams;c=d.sparams.split(",");for(e=0;e<c.length;e=e+1){a+="&"+c[e]+"="+d[c[e]]}a+="&signature="+d.signature;a+="&mv="+d.mv;a+="&sver="+d.sver;a+="&mt="+d.mt;a+="&key="+d.key;a+="&title="+b;return a}function setHtml5Player(a){if(jQuery("#dsc_video").length===0){jQuery("<video>",{id:"dsc_video",src:a,controls:"controls",autoplay:"autoplay",width:640,height:390}).appendTo(jQuery("#watch-player").parent());document.getElementById("watch-player").parentNode.removeChild(document.getElementById("watch-player"))}else{jQuery("#dsc_video").attr("src",a)}}function createButtonUI(){jQuery("<img/>",{"class":"yt-uix-button-arrow",src:"//s.ytimg.com/yt/img/pixel-vfl73.gif",alt:""}).appendTo(jQuery("<button>",{type:"button",id:"dsc-button",onclick:";return false;","class":"yt-uix-tooltip-reverse yt-uix-button yt-uix-button-default yt-uix-tooltip",title:"Descarga el video",html:'<span class="yt-uix-button-content">Descargar </span>',"data-button-menu-id":"dsc-list-menu",role:"button","aria-pressed":"false","aria-expanded":"false"}).appendTo("#watch-actions"))}function createDropDownMenuUI(){jQuery("<ul>",{"class":"flag-menu"}).appendTo(jQuery("<div>",{"class":"yt-uix-button-menu yt-uix-button-menu-external hid",id:"dsc-list-menu"}).appendTo("body"))}function addItemToList(c,e){var b="",a,d;if(formats[c.itag]){b=formats[c.itag].description+" ("+formats[c.itag].format+")"}else{b="Desconocido ("+c.itag+")"}a=jQuery("<a>",{href:e,text:b,"class":"yt-uix-button-menu-item"}).appendTo("#dsc-list-menu ul");d=document.createElement("video");if(d.canPlayType(c.type)!==""){jQuery("<span>",{"class":"label",text:"H5",title:"Play in HTML5",css:{position:"absolute",right:"0.6666em",opacity:"0.6","float":"right"},click:function(){setHtml5Player(jQuery(this).parent().attr("href"));return false}}).appendTo(a)}}(function(){testJquery(function(){var a=getVideoId(location.href);if(a){getVideoData(a,function(e){createButtonUI();createDropDownMenuUI();var c,b,d;b=jQuery("#eow-title").attr("title");for(c=0;c<e.length;c=c+1){d=createVideoUrl(e[c],b);addItemToList(e[c],d)}})}})}());
