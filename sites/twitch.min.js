function getVideoId(){"use strict";var t,e,n=location.href;return t=/^.*twitch\.tv\/videos\/([0-9]+)*/,e=n.match(t),e?e[1]:!1}function createButtonUI(t){"use strict";var e,n,s,o;e=document.getElementById("dsc-button"),null!==e&&e.parentNode.removeChild(e),n=document.createElement("span"),n.id="dsc-button",n.setAttribute("class","ember-view"),s=document.createElement("a"),s.setAttribute("class","button mg-l-1"),s.textContent="Descarga ",s.href=t,n.appendChild(s),document.getElementsByClassName("video-info-bar__action-container")[0].appendChild(n),n.onclick=function(){o=document.getElementById("dsc-list-menu"),o&&("none"===o.style.display?o.style.display="block":o.style.display="none",o.style.top=s.offsetTop-(o.offsetHeight+5)+"px",o.style.left=s.offsetLeft+"px")}}function getClientId(t){"use strict";var e,n="https://player.twitch.tv/js/player.js";e=XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),e.onreadystatechange=function(){if(4===e.readyState&&200===e.status){var n=e.responseText,s=/\{"Client-ID":"(\w+)"\}/,o=s.exec(n);null!==o&&(o.index===s.lastIndex&&(s.lastIndex=s.lastIndex+1),t(o[1]))}},e.open("GET",n,!0),e.send()}function getVideoUrl(t,e,n){"use strict";var s,o="https://api.twitch.tv/api/vods/"+t+"/access_token?client_id="+e+"&format=json";s=XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),s.onreadystatechange=function(){if(4===s.readyState&&200===s.status){var e=JSON.parse(s.responseText),o=e.sig,i=encodeURIComponent(e.token),a="http://usher.twitch.tv/vod/"+t+"?nauthsig="+o+"&nauth="+i;n(a)}},s.open("GET",o,!0),s.send()}!function(){"use strict";var t=getVideoId();t&&getClientId(function(e){getVideoUrl(t,e,function(t){createButtonUI(t)})})}();