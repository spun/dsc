function getVideoId(){"use strict";var a,b,c=location.href;return a=/^.*(twitch\.tv\/[\w]+\/[b\|c\|v]\/)([0-9]+)*/,b=c.match(a),!!b&&b[2]}function createButtonUI(a){"use strict";var b,c,d,e;b=document.getElementById("dsc-button"),null!==b&&b.parentNode.removeChild(b),c=document.createElement("span"),c.id="dsc-button",c.setAttribute("class","ember-view"),d=document.createElement("a"),d.setAttribute("class","button glyph-only"),d.textContent="Descarga ",d.href=a,c.appendChild(d),document.getElementsByClassName("channel-actions")[0].appendChild(c),c.onclick=function(){e=document.getElementById("dsc-list-menu"),e&&("none"===e.style.display?e.style.display="block":e.style.display="none",e.style.top=d.offsetTop-(e.offsetHeight+5)+"px",e.style.left=d.offsetLeft+"px")}}function getClientId(a){"use strict";var b,c="https://player.twitch.tv/js/player.js";b=XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),b.onreadystatechange=function(){if(4===b.readyState&&200===b.status){var c=b.responseText,d=/\{"Client-ID":"(\w+)"\}/,e=d.exec(c);null!==e&&(e.index===d.lastIndex&&(d.lastIndex=d.lastIndex+1),a(e[1]))}},b.open("GET",c,!0),b.send()}function getVideoUrl(a,b,c){"use strict";var d,e="https://query.yahooapis.com/v1/public/yql?q="+encodeURIComponent('select * from json where url="https://api.twitch.tv/api/vods/'+a+"/access_token?client_id="+b+'"')+"&format=json";d=XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),d.onreadystatechange=function(){if(4===d.readyState&&200===d.status){var b=JSON.parse(d.responseText).query.results.json,e=b.sig,f=encodeURIComponent(b.token),g="http://usher.twitch.tv/vod/"+a+"?nauthsig="+e+"&nauth="+f;c(g)}},d.open("GET",e,!0),d.send()}!function(){"use strict";var a=getVideoId();a&&getClientId(function(b){getVideoUrl(a,b,function(a){createButtonUI(a)})})}();